<!-- app\templates\dashboard_partials\card_proximos_venc.html -->
<div class="card shadow-sm h-100">
  <div
    class="card-header bg-light py-2 d-flex justify-content-between align-items-center"
  >
    <h6 class="fw-bold mb-0 text-secondary small text-uppercase">
      <i class="fas fa-calendar-check me-1"></i> Próx. Vencimentos
    </h6>
    <div style="width: 100px">
      {{ form_movimentos.mes_ano(class="form-control form-control-sm py-0 px-1
      text-center small border-0 bg-transparent", id="mes_ano_dashboard_card")
      }}
    </div>
  </div>
  <div class="card-body p-0" style="overflow-y: auto; max-height: 400px">
    {% if proximos_movimentos %}
    <ul class="list-group list-group-flush">
      {% for item in proximos_movimentos %}
      <li
        class="list-group-item p-2 d-flex justify-content-between align-items-center"
      >
        <div class="overflow-hidden me-2">
          <div
            class="fw-semibold text-dark small text-truncate"
            title="{{ item.descricao }}"
          >
            {{ item.descricao }}
          </div>
          <div class="text-muted extra-small">
            {{ item.data.strftime('%d/%m') }}
          </div>
        </div>
        <span
          class="badge rounded-pill {% if item.tipo == 'Saída' %}bg-danger-subtle text-danger-emphasis{% else %}bg-success-subtle text-success-emphasis{% endif %}"
        >
          {{ item.valor | format_number }}
        </span>
      </li>
      {% endfor %}
    </ul>
    {% else %}
    <div class="text-center py-4">
      <i class="fas fa-check-circle text-success fa-2x mb-2 opacity-50"></i>
      <p class="text-muted small mb-0">Tudo pago por enquanto!</p>
    </div>
    {% endif %}
  </div>
</div>
<script>
  document
    .getElementById("mes_ano_dashboard_card")
    ?.addEventListener("change", function () {
      const url = new URL(window.location.href);
      url.searchParams.set("mes_ano", this.value);
      window.location.href = url.toString();
    });
</script>
