<!-- app\templates\alertas\contas_vencidas.html -->

{% extends "base.html" %} {% block content %}

<div
  class="caixa-sombreada-cinza p-2 d-flex justify-content-between align-items-center mb-2"
>
  <h4 class="mb-0">
    <i class="fas fa-exclamation-triangle text-danger me-2"></i>Contas Vencidas
  </h4>
  <a href="{{ url_for('main.dashboard') }}" class="btn btn-cinza">
    <i class="fas fa-arrow-left text-warning me-3"></i>Voltar
  </a>
</div>

<div class="card shadow-sm">
  <div class="card-body">
    <div class="table-responsive">
      <table class="table table-striped table-hover">
        <thead>
          <tr>
            <th>Vencimento</th>
            <th>Descrição</th>
            <th class="text-end">Valor Pendente</th>
            <th class="text-center">Tipo</th>
            <th class="text-center">Ações</th>
          </tr>
        </thead>
        <tbody>
          {% for item in movimentos %}
          <tr>
            <td>
              {{ item.data.strftime('%d/%m/%Y') }}
              <span class="badge bg-danger ms-1">Vencido</span>
            </td>
            <td>{{ item.descricao }}</td>
            <td class="text-end">{{ item.valor | format_currency }}</td>
            <td class="text-center">
              {% if item.natureza == 'Despesa' %}
              <span class="badge bg-danger-subtle text-danger-emphasis"
                >A Pagar</span
              >
              {% else %}
              <span class="badge bg-success-subtle text-success-emphasis"
                >A Receber</span
              >
              {% endif %}
            </td>
            <td class="text-center">
              {% if item.natureza == 'Despesa' %}
              <button
                type="button"
                class="btn btn-link text-danger p-0"
                data-bs-toggle="modal"
                data-bs-target="#pagamentoModal"
                data-item-id="{{ item.id_original }}"
                data-item-tipo="{{ item.tipo_item }}"
                data-item-valor="{{ item.valor_para_modal }}"
                data-item-descricao="{{ item.descricao }}"
                title="Registrar Pagamento"
              >
                <i class="fas fa-hand-holding-usd fa-sm"></i>
              </button>
              {% else %}
              <button
                type="button"
                class="btn btn-link text-success p-0"
                data-bs-toggle="modal"
                data-bs-target="#recebimentoModal"
                data-item-id="{{ item.id_original }}"
                data-item-tipo="{{ item.tipo_item }}"
                data-item-valor="{{ item.valor_para_modal }}"
                data-item-descricao="{{ item.descricao }}"
                data-conta-sugerida-id="{{ item.conta_sugerida_id or '' }}"
                data-folha-tem-fgts="{{ 'true' if item.folha_tem_fgts else 'false' }}"
                title="Registrar Recebimento"
              >
                <i class="fas fa-hand-holding-usd fa-sm"></i>
              </button>
              {% endif %}
            </td>
          </tr>
          {% else %}
          <tr>
            <td colspan="5" class="text-center">
              Ótimo! Nenhuma conta vencida encontrada.
            </td>
          </tr>
          {% endfor %}
        </tbody>
      </table>
    </div>
  </div>
</div>

{% include 'includes/_modal_pagamento.html' %} {% include
'includes/_modal_recebimento.html' %} {% endblock %} {% block scripts %} {{
super() }}

<script type="application/json" id="json-data-pagamentos">
  {{ contas_json | tojson }}
</script>
<script type="application/json" id="contas-data">
  {{ contas_json | tojson }}
</script>
<script type="application/json" id="fgts-info-data">
  {{ fgts_info | tojson }}
</script>

<script src="{{ url_for('static', filename='js/modals.js') }}"></script>
<script src="{{ url_for('static', filename='js/pagamentos.js') }}"></script>
<script src="{{ url_for('static', filename='js/recebimentos.js') }}"></script>

{% endblock %}
