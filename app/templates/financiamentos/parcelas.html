<!--- app\templates\financiamentos\parcelas.html -->

{% extends "base.html" %}

{% block title %}Parcelas de {{ financiamento.nome_financiamento }}{% endblock
%}
{% block page_title %}Parcelas de {{ financiamento.nome_financiamento }}{%
endblock %}

{% block content %}
<div class="row">
    <div class="col-12">
        <div class="d-flex justify-content-end mb-3">
            <a href="{{ url_for('financiamento.listar_financiamentos') }}"
                class="btn btn-secondary btn-add">
                <i class="fas fa-arrow-left"></i> Voltar
            </a>
        </div>

        <div class="card shadow-sm">
            <div class="card-header bg-dark text-white">
                <h5 class="mb-0">Parcelas do Financiamento</h5>
            </div>
            <div class="card-body">
                {% if parcelas %}
                <div class="table-responsive">
                    <table class="table table-striped table-hover">
                        <thead>
                            <tr>
                                <th>#</th>
                                <th>Vencimento</th>
                                <th>Valor Principal</th>
                                <th>Juros</th>
                                <th>Seguros</th>
                                <th>Taxas</th>
                                <th>Ajustes</th>
                                <th>Valor Total</th>
                                <th>Status</th>
                                <th>Data Pagamento</th>
                                <th>Observações</th>
                            </tr>
                        </thead>
                        <tbody>
                            {% for p in parcelas %}
                            <tr>
                                <td>{{ p.numero_parcela }}</td>
                                <td>{{ p.data_vencimento.strftime('%d/%m/%Y')
                                    }}</td>
                                <td>R$ {{ "%.2f"|format(p.valor_principal)
                                    }}</td>
                                <td>R$ {{ "%.2f"|format(p.valor_juros) }}</td>
                                <td>R$ {{ "%.2f"|format(p.valor_seguro +
                                    p.valor_seguro_2 + p.valor_seguro_3) }}</td>
                                <td>R$ {{ "%.2f"|format(p.valor_taxas) }}</td>
                                <td>R$ {{ "%.2f"|format(p.ajustes) }}</td>
                                <td class="fw-bold">R$ {{
                                    "%.2f"|format(p.valor_total_previsto)
                                    }}</td>
                                <td>
                                    {% if p.status == 'Paga' %}
                                    <span class="badge bg-success">{{ p.status
                                        }}</span>
                                    {% elif p.status == 'Atrasada' %}
                                    <span class="badge bg-danger">{{ p.status
                                        }}</span>
                                    {% elif p.status == 'Amortizada' %}
                                    <span class="badge bg-primary">{{ p.status
                                        }}</span>
                                    {% else %}
                                    <span class="badge bg-secondary">{{ p.status
                                        }}</span>
                                    {% endif %}
                                </td>
                                <td>{{ p.data_pagamento.strftime('%d/%m/%Y') if
                                    p.data_pagamento else 'N/A' }}</td>
                                <td>{{ p.observacoes if p.observacoes else ''
                                    }}</td>
                            </tr>
                            {% endfor %}
                        </tbody>
                    </table>
                </div>
                {% else %}
                <div class="alert alert-warning text-center">
                    Nenhuma parcela encontrada para este financiamento.
                    <a
                        href="{{ url_for('financiamento.importar_parcelas', id=financiamento.id) }}"
                        class="alert-link">Clique aqui para importá-las</a>.
                </div>
                {% endif %}
            </div>
        </div>
    </div>
</div>
{% endblock %}
